+title: Working with OpenSpec with multiple Claude profiles
#+author: HaQadosch
#+date: [2026-02-15 Sun]
#+startup: indent
#+property: header-args :results output
* Step 1: Create the different profiles
We want to start with the following profiles:
- The requirement analyst
- The solution architect
- The developer
- The reviewer

The process is to generate the profile for each project based on the
specific needs ( tech stack, constraints, ... ) of that project.

The goal, medium term, would be to use a good architecture and tech
stack (including AI) in order to go through the Flavio's course.[fn:1]
Looking at the curriculum, the first week is about an app with a DB.

#+begin_quote
BUILD AN APP WITH A DATABASE

Build a real app that saves data from day one
PROJECT: PERSONAL DASHBOARD
WHAT YOU'LL LEARN

    Describe what you want to AI and get a working app
    Understand what a database does and why your app needs one
    Build forms that create, edit, and delete records
    Run your app locally and use it every day
#+end_quote

I'm going for a book tracking with the added extra of asking why I'm
adding this book in the todo, and what I expect from this book. This
will give an angle to start reading as it could take a while before I
start it. It also gives a theme around that book and would create a
grouping of books based on common themes.

I would like to use TanStack and SQlite, so I'm basing the profiles
based on those tech.

Maybe a *offline first*, *monorepo*, and *MFE*, could be a thing to do as
well ü§î ?
Thinking about:
- [[https://github.com/mitchellh/vouch][Vouch]]
- [[https://ipfs.tech/][IPFS]]
- [[https://posthog.com/][Posthog]]
- A TUI as web interface[fn:2]
- A pure TUI interface[fn:3]
- Check [[https://owasp.org/Top10/2025/][OWASP]] list for security
- [[https://github.com/tigerbeetle/tigerbeetle/blob/main/docs/TIGER_STYLE.md][Tigerbeetle]] style
- local first, CRDT database
- pure SSH app
- Fuzzy test ?

After some discussions worthy of 2 ADRs, we have the tech stack. Now I
can create the 4 personnas.
#+begin_quote
Create the four personnas, taking into account the kind of app we're
building as detailled in implementationPlan.org
#+end_quote

Changed the tech stack to the full TanStack Router; creating ADR.

Changed the tech stack to include dotenvx as well; creating ADR.

Changed the tech stack to add XState; creating ADR.
* Step 2: OpenSpec and the OPSX workflow
Let's try the new new workflow.[fn:4]

#+begin_src bash
  openspec init
#+end_src

Quick start after setup:
- ~/opsx:new~ :: Create a change
- ~/opsx:continue~ :: Next artifact
- ~/opsx:apply~ :: Implement tasks
** Create schema template in your project
The idea here is to adapt opsx to the specifics of your project.
#+begin_src bash
  openspec schema fork spec-driven <project-workflow>
  # modify the schema
  openspec schema validate <project-workflow>
#+end_src
** Apparent friction with the old set up
The 4 personas created earlier are not really compatible with the way
*opsx* works. They're quite rigid and are made to be attached to a new
*claude* session at each step. *opsx* wants to do everything in any
order during the same session.

We could inject some of the 4 personas config into the *opsx*
different configuration files.
** update the claude.md file
I ask claude to update it's [[file:CLAUDE.md][claude.md]] file accordingly.
* Step 3: Scaffold and pipes
** opsx:new
Let's start with creating the basic scaffold for the project.
#+begin_src bash
  /opsx:new scaffold-and-pipes
#+end_src
*** TODO display the todo list in Opencode right tab
Opencode can display lots of useful info:
- Context
- MCP
- LSP
- Modified Files
- Git branch
- and sometimes the todo from Claude

Try and include the opsx todo in the Claude todo.
Also try and include the current folder/worktree
*** Numbering opsx artifacts
Opened a ticket to opsx repo about numbering the artifacts, a la madr,
and proposing the idea of artifact explorer like docusorus and the like.[fn:5]
** opsx:continue -> design
To check the current status (or *change* in opsx parlance) of the
project as a whole, with all the current tasks:
#+name: openspec list
#+begin_src bash
  openspec list
#+end_src

#+RESULTS: openspec list
: Changes:
:   scaffold-and-pipes     No tasks      1h ago

I can see there is a task in "progress".
Let's focus on that one:
#+name: openspec status 1
#+begin_src bash
  openspec status --change scaffold-and-pipes
#+end_src

#+RESULTS: openspec status 1
: Change: scaffold-and-pipes
: Schema: book-app-workflow
: Progress: 1/4 artifacts complete
:
: [x] proposal
: [ ] design
: [ ] specs
: [-] tasks (blocked by: design, specs)

I could use ~openspec show scaffold-and-pipes~ to see the content as well.
At this stage, this would be the [[file:openspec/changes/scaffold-and-pipes/proposal.md][proposal]].
Based on the progress track, next step is *design*.

#+begin_src bash
  /opsx:continue
#+end_src

It created the [[file:openspec/changes/scaffold-and-pipes/design.md][design]] doc.

It wanted to pin the node version to v22 but the latest LTS for node
is [[https://nodejs.org/en/blog/release/v24.13.1][v24.13]], so forced the change.

#+begin_src bash
  Created: design.md
  Progress: 2/4 ‚Äî design done, tasks now only blocked by specs.
  [x] proposal
  [x] design
  [ ] specs     ‚Üê next
  [-] tasks     (blocked by: specs)
#+end_src
** opsx:continue -> spec
For the specs, it creates a new type of artifacts, in [[file:openspec/changes/scaffold-and-pipes/specs/project-scaffold/spec.md][spec.md]]

#+begin_src bash
  Created: specs/project-scaffold/spec.md
  Progress: 3/4 ‚Äî only tasks remaining, now unblocked.

  [x] proposal
  [x] design
  [x] specs
  [ ] tasks     ‚Üê next

  Six requirements defined, each with testable WHEN/THEN scenarios:
  1. App builds and serves a default page
  2. Node.js version pinned (24.13 LTS)
  3. Environment variables via dotenvx
  4. Database connection module exists
  5. Vitest smoke test passes
  6. Prettier configured and passing

  Want to continue with tasks?
#+end_src




* Footnotes

[fn:5] https://github.com/Fission-AI/OpenSpec/issues/721

[fn:4] https://github.com/Fission-AI/OpenSpec/blob/main/docs/opsx.md
There is also the getting started that looks like a nice run through.
https://github.com/Fission-AI/OpenSpec/blob/main/docs/getting-started.md
and commands reference
https://github.com/Fission-AI/OpenSpec/blob/main/docs/commands.md

[fn:3] https://github.com/vadimdemedes/ink

[fn:2] https://frankentui.com/web_react

[fn:1] https://bootcamp.dev/
